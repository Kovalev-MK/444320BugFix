<?xml version="1.0" encoding="utf-8"?>
<queries>
  <query key="ParametersTableExist">
    <mssql><![CDATA[SELECT
cast(case
when exists(select 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'lenspec_OutgoingLetters_Params') then 1
else 0
end as bit)]]></mssql>
    <postgres><![CDATA[SELECT EXISTS (
   SELECT FROM pg_tables
   WHERE  schemaname = 'public'
   AND    tablename  = 'lenspec_OutgoingLetters_Params'
   );]]></postgres>
  </query>
  <query key="CreateParametersTable">
    <mssql><![CDATA[-- Создать таблицу параметров.
if not exists (select * from sys.objects where object_id = OBJECT_ID(N'[dbo].[lenspec_OutgoingLetters_Params]') and type in (N'U'))
create table [lenspec_OutgoingLetters_Params]
(
                [Key] varchar(50),
                [Value] varchar(MAX)
)]]></mssql>
    <postgres><![CDATA[DO $$
BEGIN
  CREATE TABLE IF NOT EXISTS lenspec_OutgoingLetters_Params
  (
    Key citext NOT NULL CHECK (char_length(Key::text) <= 50),
    Value citext,
    PRIMARY KEY (Key)
  );
END$$]]></postgres>
  </query>
  <query key="InsertOrUpdateParamsValue">
    <mssql><![CDATA[if not exists(select 1 from [dbo].[lenspec_OutgoingLetters_Params] where [Key] = '{0}')
  insert [lenspec_OutgoingLetters_Params] ([Key],[Value]) values ('{0}', '{1}')
else UPDATE lenspec_OutgoingLetters_Params SET [Value] = '{1}' WHERE ([Key] = '{0}')]]></mssql>
    <postgres><![CDATA[do $$
begin
  if not exists(select 1 from lenspec_OutgoingLetters_Params where Key = '{0}')
  then
    insert into lenspec_OutgoingLetters_Params (Key, Value) values ('{0}', '{1}');
  else
    UPDATE lenspec_OutgoingLetters_Params SET Value = '{1}' WHERE (Key = '{0}');
  end if;
end$$;]]></postgres>
  </query>
  <query key="SelectParamsValue">
    <mssql><![CDATA[SELECT [Value] FROM lenspec_OutgoingLetters_Params WHERE ([Key] = '{0}')]]></mssql>
    <postgres><![CDATA[SELECT Value FROM lenspec_OutgoingLetters_Params WHERE (Key = '{0}')]]></postgres>
  </query>
  <query key="DeleteParamsValue">
    <mssql><![CDATA[delete from lenspec_OutgoingLetters_Params WHERE ([Key] = '{0}')]]></mssql>
    <postgres><![CDATA[DELETE FROM lenspec_OutgoingLetters_Params WHERE (Key = '{0}')]]></postgres>
  </query>
</queries>