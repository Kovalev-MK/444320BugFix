<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReferencedAssemblies="System.dll&#13;&#10;System.Core.dll&#13;&#10;System.Drawing.dll&#13;&#10;System.Windows.Forms.dll&#13;&#10;System.Data.dll&#13;&#10;System.Xml.dll&#13;&#10;Sungero.Domain.Shared&#13;&#10;Sungero.CoreEntities.Shared&#13;&#10;Sungero.Reporting.Shared&#13;&#10;CommonLibrary&#13;&#10;Sungero.Localization&#13;&#10;Sungero.Declension&#13;&#10;Sungero.Domain.Interfaces&#13;&#10;lenspec.Etalon.Shared&#13;&#10;lenspec.Etalon.Server&#13;&#10;Sungero.Company.Shared&#13;&#10;Sungero.Company.Server&#13;&#10;lenspec.AutomatedSupportTickets.Shared&#13;&#10;lenspec.AutomatedSupportTickets.Server" ReportInfo.CreatorVersion="2020.2.12.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text.RegularExpressions;
using System.Windows.Forms;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;
using lenspec.Etalon;
using Sungero.Company;
using Sungero.Domain.Shared;
using Sungero.CoreEntities;
using Sungero.Core;
using Resources = lenspec.AutomatedSupportTickets.Reports.Resources;


namespace FastReport
{
  public class ReportScript
  {
  }
}
  </ScriptText>
  <Dictionary>
    <SungeroSqlDataConnection Name="Sungero_Connection" Restrictions="DontModify, DontEdit, DontDelete, HideAllProperties" ConnectionStringExpression="[SungeroConnectionString]">
      <TableDataSource Name="Table" Alias="Query" DataType="System.Int32" Enabled="true" CanEdit="true" SelectCommand="${QueryForTimeLastUserConnection}">
        <Column Name="Organization" DataType="System.String" PropName="Column"/>
        <Column Name="Division" DataType="System.String" PropName="Column1"/>
        <Column Name="Username" DataType="System.String" PropName="Column2"/>
        <Column Name="LoginDate" DataType="System.String" PropName="Column3"/>
        <Column Name="LogoutDate" DataType="System.String" PropName="Column"/>
        <CommandParameter Name="Employee" DataType="16" IsDbType="true" Expression="[employeeIds]"/>
        <CommandParameter Name="beginDate" DataType="6" IsDbType="true" Expression="[beginDate]"/>
        <CommandParameter Name="endDate" DataType="6" IsDbType="true" Expression="[endDate]"/>
      </TableDataSource>
    </SungeroSqlDataConnection>
    <SungeroParameter Name="SungeroConnectionString" Restrictions="DontModify, DontEdit, DontDelete, HideAllProperties, DontShow" Id="a72df196-5d84-4555-9596-69805c0efa91" IsRequired="false" IsCollection="false" InternalDataType="System.String" IsSimpleDataType="false" EntityTypeId="00000000-0000-0000-0000-000000000000"/>
    <SungeroParameter Name="businessUnit" Id="4d8bbd9d-11a8-4036-a7a1-38e2be5dc625" IsRequired="false" IsCollection="true" InternalDataType="lenspec.Etalon.IBusinessUnit, Sungero.Domain.Interfaces" IsSimpleDataType="false" EntityTypeId="61b6e79b-ef61-4cc9-90fa-bb6f4c405b66"/>
    <SungeroParameter Name="department" Id="64ec0a69-cd9e-482a-ba76-08df4c7aa962" IsRequired="false" IsCollection="true" InternalDataType="Sungero.Company.IDepartment, Sungero.Domain.Interfaces" IsSimpleDataType="false" EntityTypeId="61b1c19f-26e2-49a5-b3d3-0d3618151e12"/>
    <SungeroParameter Name="employee" Id="6aefe29a-85fa-4738-95b5-fda9b224e529" IsRequired="false" IsCollection="false" InternalDataType="lenspec.Etalon.IEmployee, Sungero.Domain.Interfaces" IsSimpleDataType="false" EntityTypeId="bc049649-73a8-4fa7-96ca-d0a60babf65f"/>
    <SungeroParameter Name="beginDate" Id="5c1bef81-0512-4c24-a111-c6a53ff9ea13" IsRequired="false" IsCollection="false" InternalDataType="System.DateTime" IsSimpleDataType="true" EntityTypeId="00000000-0000-0000-0000-000000000000"/>
    <SungeroParameter Name="endDate" Id="78e8572f-bbf3-43fe-bfbf-1492782ccefe" IsRequired="false" IsCollection="false" InternalDataType="System.DateTime" IsSimpleDataType="true" EntityTypeId="00000000-0000-0000-0000-000000000000"/>
    <SungeroParameter Name="employeeIds" Id="37c106f0-96c5-455f-bf65-c072379d9ca1" IsRequired="false" IsCollection="false" InternalDataType="System.String" IsSimpleDataType="false" EntityTypeId="00000000-0000-0000-0000-000000000000"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210" Watermark.Font="Arial, 60pt" UnlimitedHeight="true">
    <ReportTitleBand Name="ReportTitle1" Width="1047.06" Height="47.25">
      <TextObject Name="Text1" Left="9.45" Width="1030.05" Height="18.9" Text="Время подключения пользователей" HorzAlign="Center" Font="Arial, 12pt">
        <Formats>
          <DateFormat Format="dd.MM.yyyy"/>
          <DateFormat Format="dd.MM.yyyy"/>
          <GeneralFormat/>
        </Formats>
      </TextObject>
      <TextObject Name="Text6" Left="340.2" Top="18.9" Width="368.55" Height="18.9" Text="в период с [beginDate] по [endDate]" HorzAlign="Center" Font="Arial, 10pt"/>
    </ReportTitleBand>
    <GroupHeaderBand Name="GroupHeader1" Top="51.25" Width="1047.06" Height="37.8" Condition="[Query.Division]">
      <TextObject Name="Text8" Left="217.35" Width="292.95" Height="37.8" Border.Lines="All" Fill.Color="Silver" Text="Подразделение" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text9" Left="510.3" Width="245.7" Height="37.8" Border.Lines="All" Fill.Color="Silver" Text="Пользователь" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text10" Left="756" Width="141.75" Height="37.8" Border.Lines="All" Fill.Color="Silver" Text="Дата и время начала сеанса" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text11" Left="897.75" Width="141.75" Height="37.8" Border.Lines="All" Fill.Color="Silver" Text="Дата и время завершения сеанса" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text7" Width="217.35" Height="37.8" Border.Lines="All" Fill.Color="DarkGray" Text="Наша организация" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
      <DataBand Name="Data1" Top="93.05" Width="1047.06" Height="37.8" CanGrow="true" CanShrink="true" DataSource="Table" KeepTogether="true">
        <TextObject Name="Text2" Width="217.35" Height="28.35" Border.Lines="All" CanGrow="true" CanShrink="true" GrowToBottom="true" CanBreak="false" Text="[Query.Organization]" Duplicates="Merge" Font="Arial, 10pt"/>
        <TextObject Name="Text3" Left="217.35" Width="292.95" Height="28.35" Border.Lines="All" CanGrow="true" CanShrink="true" GrowToBottom="true" CanBreak="false" Text="[Query.Division]" Duplicates="Merge" Font="Arial, 10pt"/>
        <TextObject Name="Text4" Left="510.3" Width="245.7" Height="28.35" Border.Lines="All" CanGrow="true" CanShrink="true" GrowToBottom="true" CanBreak="false" Text="[Query.Username]" Duplicates="Merge" Font="Arial, 10pt"/>
        <TextObject Name="Text5" Left="756" Width="141.75" Height="28.35" Border.Lines="All" CanGrow="true" CanShrink="true" GrowToBottom="true" CanBreak="false" Text="[Query.LoginDate]" HorzAlign="Center" Font="Arial, 10pt">
          <Formats>
            <GeneralFormat/>
            <GeneralFormat/>
          </Formats>
        </TextObject>
        <TextObject Name="Text12" Left="897.75" Width="141.75" Height="28.35" Border.Lines="All" CanGrow="true" CanShrink="true" GrowToBottom="true" CanBreak="false" Text="[Query.LogoutDate]" HideZeros="true" NullValue=" " HorzAlign="Center" Font="Arial, 10pt">
          <Formats>
            <GeneralFormat/>
            <GeneralFormat/>
          </Formats>
        </TextObject>
        <Sort>
          <Sort Expression="[Query.Username]"/>
          <Sort Expression="[Query.LoginDate]"/>
          <Sort Expression="[Query.LogoutDate]"/>
        </Sort>
      </DataBand>
    </GroupHeaderBand>
  </ReportPage>
</Report>
