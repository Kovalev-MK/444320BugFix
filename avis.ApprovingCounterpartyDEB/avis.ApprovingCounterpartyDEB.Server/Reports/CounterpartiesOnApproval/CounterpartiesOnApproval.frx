<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReferencedAssemblies="System.dll&#13;&#10;System.Core.dll&#13;&#10;System.Drawing.dll&#13;&#10;System.Windows.Forms.dll&#13;&#10;System.Data.dll&#13;&#10;System.Xml.dll&#13;&#10;Sungero.Domain.Shared&#13;&#10;Sungero.CoreEntities.Shared&#13;&#10;Sungero.Reporting.Shared&#13;&#10;CommonLibrary&#13;&#10;Sungero.Localization&#13;&#10;Sungero.Declension&#13;&#10;Sungero.Domain.Interfaces&#13;&#10;avis.ApprovingCounterpartyDEB.Shared&#13;&#10;avis.ApprovingCounterpartyDEB.Server" ReportInfo.CreatorVersion="2020.2.12.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text.RegularExpressions;
using System.Windows.Forms;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;
using Sungero.Domain.Shared;
using Sungero.CoreEntities;
using Sungero.Core;
using Resources = avis.ApprovingCounterpartyDEB.Reports.Resources;


namespace FastReport
{
  public class ReportScript
  {
  }
}
  </ScriptText>
  <Dictionary>
    <SungeroSqlDataConnection Name="Sungero_Connection" Restrictions="DontModify, DontEdit, DontDelete, HideAllProperties" ConnectionStringExpression="[SungeroConnectionString]">
      <TableDataSource Name="Table" Alias="TaskOnApproval" DataType="System.Int32" Enabled="true" CanEdit="true" SelectCommand="${TasksOnApproval}">
        <Column Name="Id" DataType="System.Int64" PropName="Column"/>
        <Column Name="StartDate" DataType="System.DateTime" PropName="Column"/>
        <Column Name="Status" DataType="System.String" PropName="Column"/>
        <Column Name="Initiator" DataType="System.String" PropName="Column"/>
        <Column Name="Counterparty" DataType="System.String" PropName="Column"/>
        <Column Name="TIN" DataType="System.String" PropName="Column"/>
        <Column Name="CounterpartyGroup" DataType="System.String" PropName="Column"/>
        <Column Name="IsProvider" DataType="System.Boolean" PropName="Column"/>
        <Column Name="IsContractor" DataType="System.Boolean" PropName="Column"/>
        <Column Name="DateOfBirth" DataType="System.DateTime" PropName="Column"/>
        <Column Name="Created" DataType="System.DateTime" PropName="Column"/>
        <Column Name="Approvaler" DataType="System.String" PropName="Column"/>
        <Column Name="Result" DataType="System.String" PropName="Column"/>
        <Column Name="Complited" DataType="System.DateTime" PropName="Column"/>
        <Column Name="Expired" DataType="System.Int32" PropName="Column"/>
        <Column Name="PeriodComplete" DataType="System.Int32" PropName="Column"/>
        <Column Name="Num" DataType="System.Int32" PropName="Column"/>
        <Column Name="Deadline" DataType="System.DateTime" PropName="Column"/>
        <Column Name="AssignmentDeadline" DataType="System.DateTime" PropName="Column"/>
        <Column Name="BusinessUnit" DataType="System.String" PropName="Column"/>
        <Column Name="DiscriminatorCP" DataType="System.String" PropName="Column"/>
        <CommandParameter Name="ValidFrom" DataType="6" IsDbType="true" Expression="[ValidFrom]"/>
        <CommandParameter Name="ValidTill" DataType="6" IsDbType="true" Expression="[ValidTill]"/>
        <CommandParameter Name="Status" DataType="16" IsDbType="true" Expression="[Status]"/>
        <CommandParameter Name="ApprovalerId" DataType="11" IsDbType="true" Expression="[ApprovalerId]"/>
      </TableDataSource>
    </SungeroSqlDataConnection>
    <SungeroParameter Name="SungeroConnectionString" Restrictions="DontModify, DontEdit, DontDelete, HideAllProperties, DontShow" Id="cfbd50e5-acf8-4b01-bfff-59c1362460ba" IsRequired="false" IsCollection="false" InternalDataType="System.String" IsSimpleDataType="false" EntityTypeId="00000000-0000-0000-0000-000000000000"/>
    <SungeroParameter Name="ValidFrom" Id="ba88eae0-e9ed-4737-b7f5-bad44b63b77a" IsRequired="false" IsCollection="false" InternalDataType="System.DateTime" IsSimpleDataType="true" EntityTypeId="00000000-0000-0000-0000-000000000000"/>
    <SungeroParameter Name="ValidTill" Id="34248ce7-c6bd-4244-b486-85859cff7d93" IsRequired="false" IsCollection="false" InternalDataType="System.DateTime" IsSimpleDataType="true" EntityTypeId="00000000-0000-0000-0000-000000000000"/>
    <SungeroParameter Name="Status" Id="dcd98334-72ab-4ccf-99c0-e59e07bde4dc" IsRequired="false" IsCollection="false" InternalDataType="System.String" IsSimpleDataType="false" EntityTypeId="00000000-0000-0000-0000-000000000000"/>
    <SungeroParameter Name="ApprovalerId" Id="8e34ebf1-b001-46f6-8ea9-16dcf0c08501" IsRequired="false" IsCollection="false" InternalDataType="System.Int64" IsSimpleDataType="true" EntityTypeId="00000000-0000-0000-0000-000000000000"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="400" PaperHeight="210" RawPaperSize="0" LeftMargin="15" TopMargin="15" RightMargin="15" BottomMargin="20" Watermark.Font="Arial, 60pt" UnlimitedHeight="true">
    <ReportTitleBand Name="ReportTitle1" Width="1398.6" Height="85.05">
      <TextObject Name="Text18" Left="9.45" Top="9.45" Width="1162.35" Height="18.9" Text="Контрагенты на согласовании" HorzAlign="Center" VertAlign="Center" Font="Arial, 14pt"/>
      <TextObject Name="Text19" Left="9.45" Top="28.35" Width="1162.35" Height="18.9" Text="Период с [[ValidFrom].ToShortDateString()] по [[ValidTill].ToShortDateString()]" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text20" Left="1171.8" Top="9.45" Width="217.35" Height="18.9" Text="[Calendar.Today.ToShortDateString()]" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
    </ReportTitleBand>
    <ColumnHeaderBand Name="ColumnHeader1" Top="89.05" Width="1398.6" Height="47.25" Guides="47.25">
      <TextObject Name="Text13" Left="992.25" Width="103.95" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Результат согласования" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text14" Left="1096.2" Width="75.6" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Дата принятия решения сотрудником ДБ" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text15" Left="1171.8" Width="75.6" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Срок согласования" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text16" Left="1247.4" Width="75.6" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Задание просрочено на (раб. дней)" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text17" Left="1323" Width="113.4" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Срок принятия решения (раб. дней)" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text9" Left="737.1" Width="75.6" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Поставщик \ подрядчик" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text1" Width="37.8" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="№п/п" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text2" Left="37.8" Width="47.25" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="ИД задачи" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text3" Left="85.05" Width="75.6" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Дата старта задачи" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text4" Left="160.65" Width="85.05" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Статус задачи" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text5" Left="245.7" Width="85.05" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Инициатор" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text6" Left="425.25" Width="85.05" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Контрагент" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text7" Left="510.3" Width="75.6" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="ИНН" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text8" Left="661.5" Width="75.6" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Группа контрагента" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text11" Left="812.7" Width="94.5" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Дата поступления задачи в ДБ" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text12" Left="907.2" Width="85.05" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Согласующий ДБ" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text30" Left="330.75" Width="94.5" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Наша организация" HorzAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text38" Left="585.9" Width="75.6" Height="47.25" Border.Lines="All" Fill.Color="SeaShell" Text="Тип контрагента" HorzAlign="Center" Font="Arial, 8pt"/>
    </ColumnHeaderBand>
    <DataBand Name="Data1" Top="140.3" Width="1398.6" Height="75.6" DataSource="Table">
      <TextObject Name="Text21" Width="37.8" Height="75.6" Border.Lines="All" Text="[TaskOnApproval.Num]" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text22" Left="37.8" Width="47.25" Height="75.6" Border.Lines="All" Cursor="Hand" Hyperlink.Expression="avis.ApprovingCounterpartyDEB.PublicFunctions.Module.Remote.GetTaskHyperlink([TaskOnApproval.Id])" Text="[TaskOnApproval.Id]" VertAlign="Center" Font="Arial, 10pt, style=Underline" TextFill.Color="Blue"/>
      <TextObject Name="Text23" Left="85.05" Width="75.6" Height="75.6" Border.Lines="All" Text="[TaskOnApproval.StartDate]" Format="Date" Format.Format="d" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text24" Left="160.65" Width="85.05" Height="75.6" Border.Lines="All" Text="[IIf([TaskOnApproval.Status] == &quot;InProcess&quot;,&quot;В работе&quot;,IIf([TaskOnApproval.Status] == &quot;Completed&quot;,&quot;Выполнена&quot;,IIf([TaskOnApproval.Status] == &quot;Suspended&quot;,&quot;Приостановлена&quot;,IIf([TaskOnApproval.Status] == &quot;Aborted&quot;,&quot;Прекращена&quot;,IIf([TaskOnApproval.Status] == &quot;UnderReview&quot;,&quot;На приемке&quot;,&quot;Черновик&quot;)))))]" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text25" Left="245.7" Width="85.05" Height="75.6" Border.Lines="All" Text="[TaskOnApproval.Initiator]" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text26" Left="425.25" Width="85.05" Height="75.6" Border.Lines="All" Text="[TaskOnApproval.Counterparty]" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text27" Left="510.3" Width="75.6" Height="75.6" Border.Lines="All" Text="[TaskOnApproval.TIN]" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text28" Left="661.5" Width="75.6" Height="75.6" Border.Lines="All" Text="[TaskOnApproval.CounterpartyGroup]" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text29" Left="737.1" Width="75.6" Height="75.6" Border.Lines="All" Text="[IIf([TaskOnApproval.IsContractor] == true &amp;&amp; [TaskOnApproval.IsProvider] == true,&quot;Подрядчик и поставщик&quot;, IIf([TaskOnApproval.IsContractor] == true,&quot;Подрядчик&quot;, IIf([TaskOnApproval.IsProvider] == true,&quot;Поставщик&quot;, &quot;&quot;)))]" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text31" Left="812.7" Width="94.5" Height="75.6" Border.Lines="All" Text="[TaskOnApproval.Created]" Format="Date" Format.Format="d" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text32" Left="907.2" Width="85.05" Height="75.6" Border.Lines="All" Text="[TaskOnApproval.Approvaler]" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text33" Left="992.25" Width="103.95" Height="75.6" Border.Lines="All" Text="[IIf([TaskOnApproval.Result] == &quot;CoopPossible&quot;,&quot;Сотрудничество возможно&quot;,IIf([TaskOnApproval.Result] == &quot;CoopWithRisks&quot;,&quot;Сотрудничество с рисками&quot;,IIf([TaskOnApproval.Result] == &quot;DoesNotReqAppr&quot;,&quot;Не требует согласования&quot;,IIf([TaskOnApproval.Result] == &quot;CoopNotRecomend&quot;,&quot;Сотрудничетсво не рекомендовано&quot;, &quot;Возможность сотрудничества не оценивалась ДЭБ&quot;))))]" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text34" Left="1096.2" Width="75.6" Height="75.6" Border.Lines="All" Text="[TaskOnApproval.Complited]" Format="Date" Format.Format="d" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text35" Left="1171.8" Width="75.6" Height="75.6" Border.Lines="All" Text="[IIf([TaskOnApproval.Deadline] == ToDateTime(&quot;01.01.0001&quot;),&quot;&quot;,[TaskOnApproval.Deadline].ToShortDateString())]" VertAlign="Center" Font="Arial, 10pt">
        <Formats>
          <GeneralFormat/>
          <GeneralFormat/>
        </Formats>
      </TextObject>
      <TextObject Name="Text36" Left="1323" Width="113.4" Height="75.6" Border.Lines="All" Text="[Sungero.CoreEntities.WorkingTime.GetDurationInWorkingDays([TaskOnApproval.Created],[TaskOnApproval.Complited])]" VertAlign="Center" Font="Arial, 10pt">
        <Formats>
          <NumberFormat UseLocale="false" DecimalDigits="0" DecimalSeparator="," GroupSeparator=" " NegativePattern="1"/>
          <GeneralFormat/>
        </Formats>
      </TextObject>
      <TextObject Name="Text37" Left="1247.4" Width="75.6" Height="75.6" Border.Lines="All" Text="[IIf([TaskOnApproval.Complited] &lt; [TaskOnApproval.AssignmentDeadline], &quot;&quot;, Sungero.CoreEntities.WorkingTime.GetDurationInWorkingDays([TaskOnApproval.AssignmentDeadline],[TaskOnApproval.Complited]))]" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text10" Left="330.75" Width="94.5" Height="75.6" Border.Lines="All" Fill.Color="White" Text="[TaskOnApproval.BusinessUnit]" VertAlign="Center" Font="Arial, 10pt"/>
      <TextObject Name="Text39" Left="585.9" Width="75.6" Height="75.6" Border.Lines="All" Fill.Color="White" Text="[IIf([TaskOnApproval.DiscriminatorCP] == &quot;593e143c-616c-4d95-9457-fd916c4aa7f8&quot; &amp;&amp; [TaskOnApproval.CounterpartyGroup] == &quot;ИП&quot;,&quot;ИП&quot;, IIf([TaskOnApproval.DiscriminatorCP] == &quot;f5509cdc-ac0c-4507-a4d3-61d7a0a9b6f6&quot;, &quot;Физ. лица&quot;, &quot;Юр. лица&quot;))]" VertAlign="Center" Font="Arial, 10pt"/>
    </DataBand>
  </ReportPage>
</Report>
